<!DOCTYPE html>
<html lang="en">
    <!-- 
SUMMARY OF MY PROJECT – STUDY POD BOOKING SYSTEM

This project was made to help USIU students book study pods more easily and fairly. I designed the layout to be simple, clean, and responsive so it works well on different devices. I used CSS Grid and Flexbox to organize everything clearly, making it easier for users to find what they need.

Some key features I added include:
- A booking form where students can choose their pod, time slot, and enter their ID.
- An insights section that shows data like the most booked pods and time slots to help track usage.
- A flagged duplicates feature to detect if the same student is trying to double-book multiple pods at the same time. This helps keep the system fair.
- A fill rate tracker to show how full each pod is getting over time.
- An undo feature so users can fix any booking mistakes easily.

I didn’t use any external libraries or frameworks—everything was done with plain HTML, CSS, and JavaScript to keep it simple and easy to understand. The design also uses USIU colors to keep it familiar and neat. My goal was to create a real solution that could actually work on campus and improve the way we manage study pods.

– Patricia Naamala
-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USIU Study Pod Hub - Advanced Booking System</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        /* 
SUMMARY OF MY STYLING – STUDY POD BOOKING SYSTEM

I used CSS to create a clean, modern, and student-friendly interface that’s easy to navigate. I started with a reset (removing margin, padding, and setting box-sizing) to keep everything consistent. Then I used Flexbox and Grid layouts to structure the page sections clearly.

The main colors are inspired by USIU branding to give the site a professional but familiar look. I made sure the booking form, insights box, and pod listings all stand out with padding, shadows, and hover effects to make the experience interactive.

For responsiveness, I made sure the layout adapts on different screen sizes using media queries and flexible units like percentages and `vh/vw`. I also used some transitions for smoother hover effects to make the UI feel more polished.

My goal was to keep things simple but effective easy for students to read and use without getting confused.

– Patricia Naamala
*/

        :root {
            --usiu-yellow: #FFD700;
            --usiu-blue: #1E3A8A;
            --usiu-medium-blue: #3B82F6;
            --dark-bg: #f8f9fa;
            --darker-bg: #ffffff;
            --card-bg: #ffffff;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --error-neon: #dc2626;
            --success-neon: #059669;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        /* Header Design */
        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            padding: 40px 0;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 4px;
            background: linear-gradient(90deg, var(--usiu-yellow), var(--usiu-blue));
            border-radius: 2px;
        }

        .header h1 {
            font-family: 'Inter', sans-serif;
            font-size: 3.5em;
            font-weight: 700;
            color: var(--usiu-blue);
            margin-bottom: 15px;
        }

        .header p {
            font-size: 1.3em;
            color: var(--text-secondary);
            font-weight: 300;
            letter-spacing: 2px;
        }

        /* Grid Layout */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        /* Booking Form Design */
        .booking-form {
            background: var(--card-bg);
            border: 2px solid var(--usiu-yellow);
            border-radius: 20px;
            padding: 30px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.1);
            transition: all 0.3s ease;
        }

        .booking-form:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(255, 215, 0, 0.2);
        }

        .form-title {
            font-family: 'Inter', sans-serif;
            font-size: 1.8em;
            margin-bottom: 25px;
            color: var(--usiu-blue);
            text-align: center;
            position: relative;
        }

        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 15px;
            background: var(--darker-bg);
            border: 2px solid var(--text-secondary);
            border-radius: 10px;
            font-size: 16px;
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: 'Exo 2', sans-serif;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--usiu-yellow);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
            transform: scale(1.02);
        }

        .book-btn {
            width: 100%;
            background: linear-gradient(45deg, var(--usiu-blue), var(--usiu-medium-blue));
            color: white;
            border: none;
            padding: 18px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .book-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(30, 58, 138, 0.4);
        }

        .book-btn:active {
            transform: translateY(-1px);
        }

        .error-container {
            background: rgba(255, 68, 68, 0.1);
            border: 2px solid var(--error-neon);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            color: var(--error-neon);
            display: none;
        }

        /* Table Design */
        .bookings-section {
            background: var(--card-bg);
            border: 2px solid var(--usiu-yellow);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.1);
        }

        .section-title {
            font-family: 'Inter', sans-serif;
            font-size: 2em;
            margin-bottom: 25px;
            color: var(--usiu-blue);
            text-align: center;
            position: relative;
        }

        .bookings-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: var(--darker-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .bookings-table th {
            background: linear-gradient(45deg, var(--usiu-blue), var(--usiu-medium-blue));
            color: white;
            padding: 20px 15px;
            text-align: left;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .bookings-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .bookings-table tr:hover {
            background: rgba(255, 215, 0, 0.1);
            transform: scale(1.01);
        }

        .bookings-table tr:hover td {
            color: var(--usiu-blue);
        }

        .remove-btn {
            background: linear-gradient(45deg, var(--usiu-blue), var(--usiu-medium-blue));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .remove-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(30, 58, 138, 0.4);
        }

        /* Insights Panel */
        .insights-panel {
            background: var(--card-bg);
            border: 2px solid var(--usiu-yellow);
            border-radius: 20px;
            padding: 30px;
            margin-top: 40px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .insights-title {
            font-family: 'Inter', sans-serif;
            font-size: 2.2em;
            margin-bottom: 30px;
            color: var(--usiu-blue);
            text-align: center;
            position: relative;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .insight-card {
            background: var(--darker-bg);
            border: 2px solid var(--accent-neon);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }



        .insight-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.2);
        }

        .insight-label {
            font-size: 1em;
            color: var(--text-secondary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .insight-value {
            font-family: 'Inter', sans-serif;
            font-size: 2.5em;
            font-weight: 700;
            color: var(--usiu-yellow);
        }

        .fill-rates-section {
            margin-top: 30px;
        }

        .fill-rates-title {
            font-family: 'Inter', sans-serif;
            font-size: 1.5em;
            margin-bottom: 20px;
            color: var(--usiu-blue);
            text-align: center;
        }

        .fill-rates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .fill-rate-item {
            background: var(--darker-bg);
            border: 2px solid var(--usiu-yellow);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .fill-rate-item:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.2);
        }

        .fill-rate-label {
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-size: 1.1em;
        }

        .fill-rate-value {
            font-family: 'Inter', sans-serif;
            font-size: 1.8em;
            font-weight: 700;
            color: var(--usiu-yellow);
        }

        /* Undo Section Styling */
        .undo-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--usiu-yellow);
        }

        .undo-btn {
            width: 100%;
            background: linear-gradient(45deg, var(--usiu-yellow), #FFA500);
            color: var(--usiu-blue);
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .undo-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.3);
        }

        .undo-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .undo-info {
            text-align: center;
            margin-top: 10px;
        }

        .undo-info small {
            color: var(--text-secondary);
            font-size: 0.85em;
        }

        /* Flagged Duplicates Section */
        .flagged-duplicates-section {
            background: var(--card-bg);
            border: 2px solid var(--usiu-yellow);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.1);
        }

        .flagged-title {
            font-family: 'Inter', sans-serif;
            font-size: 1.4em;
            font-weight: 600;
            color: var(--usiu-blue);
            margin-bottom: 15px;
            text-align: center;
        }

        .flagged-content p {
            color: var(--text-secondary);
            margin-bottom: 20px;
            text-align: center;
            font-size: 0.95em;
        }

        .flagged-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .flagged-stat {
            background: var(--darker-bg);
            border: 1px solid var(--usiu-yellow);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .flagged-stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
        }

        .flagged-label {
            display: block;
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-bottom: 5px;
            font-weight: 500;
        }

        .flagged-value {
            display: block;
            font-family: 'Inter', sans-serif;
            font-size: 1.5em;
            font-weight: 700;
            color: var(--usiu-yellow);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5em;
            }
            
            .container {
                padding: 10px;
            }
            
            .insights-grid {
                grid-template-columns: 1fr;
            }
            
            .fill-rates-grid {
                grid-template-columns: 1fr;
            }
        }


    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>USIU Study Pod Hub</h1>
            <p>Advanced Real-Time Booking Management System</p>
        </div>

        <div class="main-grid">
            <!-- Booking Form -->
            <div class="booking-form">
                <h2 class="form-title">Create New Booking</h2>
                <form id="bookingForm">
                    <div class="form-group">
                        <label for="podSelect">Select Study Pod</label>
                        <select id="podSelect" required>
                            <option value="">Choose a pod...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="timeInput">Booking Time (1-hour slots between 08:00-19:00)</label>
                        <input type="time" id="timeInput" step="3600" min="08:00" max="19:00" value="08:00" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="studentsInput">Student IDs (comma-separated)</label>
                        <input type="text" id="studentsInput" placeholder="e.g., 663221, 667211, 664532" required>
                    </div>
                    
                    <button type="submit" class="book-btn">
                        <span>Create Booking</span>
                    </button>
                </form>
                
                <div id="errors" class="error-container"></div>
                
                <!-- Undo Last Booking Button -->
                <div class="undo-section">
                    <button type="button" id="undoBtn" class="undo-btn" disabled>
                        <span>Undo Last Booking</span>
                    </button>
                    <div class="undo-info">
                        <small>Click to undo the most recent successful booking</small>
                    </div>
                </div>
            </div>

            <!-- Bookings Table -->
            <div class="bookings-section">
                <h2 class="section-title">Active Bookings Dashboard</h2>
                <table class="bookings-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Pod</th>
                            <th>Time</th>
                            <th>Students</th>
                            <th>Student IDs</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="bookingsTableBody">
                        <!-- Dynamic content -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Insights Panel -->
        <div class="insights-panel">
            <h2 class="insights-title">Analytics Dashboard</h2>
            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-label">Total Bookings</div>
                    <div class="insight-value" id="totalBookings">0</div>
                </div>
                <div class="insight-card">
                    <div class="insight-label">Unique Students</div>
                    <div class="insight-value" id="uniqueStudents">0</div>
                </div>
                <div class="insight-card">
                    <div class="insight-label">Peak Hour</div>
                    <div class="insight-value" id="busiestHour">None</div>
                </div>
                <div class="insight-card">
                    <div class="insight-label">Rule Violations</div>
                    <div class="insight-value" id="duplicateAttempts">0</div>
                </div>
            </div>
            
            <div class="flagged-duplicates-section">
                <h3 class="flagged-title">Flagged Duplicate Attempts</h3>
                <div class="flagged-content">
                    <p>This section tracks all attempts to book duplicate students or cross-pod conflicts.</p>
                    <div class="flagged-stats">
                        <div class="flagged-stat">
                            <span class="flagged-label">Total Violations:</span>
                            <span class="flagged-value" id="totalViolations">0</span>
                        </div>
                        <div class="flagged-stat">
                            <span class="flagged-label">Duplicate Students:</span>
                            <span class="flagged-value" id="duplicateStudents">0</span>
                        </div>
                        <div class="flagged-stat">
                            <span class="flagged-label">Cross-Pod Conflicts:</span>
                            <span class="flagged-value" id="crossPodConflicts">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="fill-rates-section">
                <h3 class="fill-rates-title">Pod Utilization Rates</h3>
                <div class="fill-rates-grid" id="fillRatesContainer">
                    <!-- Dynamic fill rates -->
                </div>
            </div>
        </div>
    </div>

    <script>
         /* 
SUMMARY OF MY SCRIPT – STUDY POD BOOKING SYSTEM

This JavaScript code handles the logic behind booking, flagging duplicate entries, and giving feedback to users. I used basic DOM manipulation and event listeners to keep everything simple and clear.

Key features in my script:
- When the user submits a booking, the script checks if the same ID has already booked that pod or slot. If it detects a duplicate, it flags it and alerts the user.
- I added functionality to track the number of bookings per pod so we can calculate fill rates.
- I used an undo system that allows users to remove their last booking in case of a mistake, which improves user experience.
- There’s also logic to prevent overbooking and give alerts if someone tries to book more than once.

Everything is written in plain JavaScript with no frameworks, to show I understand the core concepts. I focused on writing readable code and giving clear error messages to help users know what’s happening.

– Patricia Naamala
*/

    

        // Global variables and data structures
        const pods = [
            { id: "POD-A", capacity: 4 },
            { id: "POD-B", capacity: 4 },
            { id: "POD-C", capacity: 4 },
        ];

        let bookings = [
            { podId: "POD-A", time: "09:00", students: ["663221", "667211"] },
            { podId: "POD-B", time: "10:00", students: ["664532"] },
            { podId: "POD-C", time: "14:00", students: ["665443", "668765"] },
            { podId: "POD-B", time: "14:00", students: ["665443"] }, // Cross-pod conflict: student 665443 already in POD-C at 14:00
        ];

        let duplicateAttempts = 2; // Global counter for duplicate booking attempts (start with 2 for demo)
        let duplicateStudentsCount = 1; // Counter for duplicate student attempts (start with 1 for demo)
        let crossPodConflictsCount = 1; // Counter for cross-pod conflicts (start with 1 for demo)
        let bookingHistoryStack = []; // Stack to store recent successful bookings

        // DOM elements
        let podSelect, timeInput, studentsInput, bookingForm, errorsContainer;
        let bookingsTableBody, totalBookingsEl, uniqueStudentsEl, busiestHourEl;
        let duplicateAttemptsEl, fillRatesContainer, totalViolationsEl, duplicateStudentsEl, crossPodConflictsEl;
        let undoBtn;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeElements();
            populatePodSelect();
            renderBookingsTable();
            recomputeInsights();
            
            // Set default time to 08:00
            timeInput.value = "08:00";
        });

        // Initialize DOM element references
        function initializeElements() {
            podSelect = document.getElementById('podSelect');
            timeInput = document.getElementById('timeInput');
            studentsInput = document.getElementById('studentsInput');
            bookingForm = document.getElementById('bookingForm');
            errorsContainer = document.getElementById('errors');
            bookingsTableBody = document.getElementById('bookingsTableBody');
            totalBookingsEl = document.getElementById('totalBookings');
            uniqueStudentsEl = document.getElementById('uniqueStudents');
            busiestHourEl = document.getElementById('busiestHour');
            duplicateAttemptsEl = document.getElementById('duplicateAttempts');
            fillRatesContainer = document.getElementById('fillRatesContainer');
            totalViolationsEl = document.getElementById('totalViolations');
            duplicateStudentsEl = document.getElementById('duplicateStudents');
            crossPodConflictsEl = document.getElementById('crossPodConflicts');
            undoBtn = document.getElementById('undoBtn');

            // Add event listeners
            bookingForm.addEventListener('submit', handleFormSubmit);
            bookingsTableBody.addEventListener('click', handleTableClick);
            undoBtn.addEventListener('click', handleUndoBooking);
        }

        // Populate pod select options using DOM manipulation
        function populatePodSelect() {
            for (let i = 0; i < pods.length; i++) {
                const pod = pods[i];
                const option = document.createElement('option');
                option.value = pod.id;
                option.textContent = `${pod.id} (Capacity: ${pod.capacity})`;
                podSelect.appendChild(option);
            }
        }

        // Handle form submission
        function handleFormSubmit(event) {
            event.preventDefault();
            clearErrors();

            const podId = podSelect.value;
            const time = timeInput.value;
            const studentsInputValue = studentsInput.value;

            // Validate inputs
            if (!podId || !time || !studentsInputValue.trim()) {
                showError("All fields are required.");
                return;
            }

            // Parse student IDs
            const studentIds = parseStudentIds(studentsInputValue);
            if (studentIds.length === 0) {
                showError("Please enter at least one valid student ID.");
                return;
            }

            // Validate operating hours
            if (!isWithinOperatingHours(time)) {
                showError("Bookings are only allowed between 08:00 and 19:00.");
                return;
            }

            // Check capacity rule
            const existingBooking = findBooking(podId, time);
            const totalStudents = existingBooking ? 
                existingBooking.students.length + studentIds.length : 
                studentIds.length;

            if (totalStudents > 4) {
                showError(`Pod capacity exceeded. Maximum 4 students allowed.`);
                return;
            }

            // Check for duplicate students in the same booking
            const duplicateStudents = [];
            for (let i = 0; i < studentIds.length; i++) {
                const studentId = studentIds[i];
                if (existingBooking && existingBooking.students.includes(studentId)) {
                    duplicateStudents.push(studentId);
                }
            }

            if (duplicateStudents.length > 0) {
                duplicateAttempts++;
                duplicateStudentsCount++;
                showError(`Duplicate booking detected for students: ${duplicateStudents.join(', ')}`);
                return;
            }

            // Check for cross-pod clashes
            const clashStudents = [];
            for (let i = 0; i < studentIds.length; i++) {
                const studentId = studentIds[i];
                if (hasCrossPodClash(studentId, time, podId)) {
                    clashStudents.push(studentId);
                }
            }

            if (clashStudents.length > 0) {
                duplicateAttempts++;
                crossPodConflictsCount++;
                showError(`Students already booked in another pod at this time: ${clashStudents.join(', ')}`);
                return;
            }

            // Add booking
            let newBooking = null;
            if (existingBooking) {
                // Add to existing booking
                for (let i = 0; i < studentIds.length; i++) {
                    existingBooking.students.push(studentIds[i]);
                }
                newBooking = existingBooking;
            } else {
                // Create new booking
                newBooking = {
                    podId: podId,
                    time: time,
                    students: studentIds
                };
                bookings.push(newBooking);
            }
            
            // Add to booking history stack
            bookingHistoryStack.push({
                booking: JSON.parse(JSON.stringify(newBooking)), // Deep copy
                timestamp: new Date().toLocaleTimeString()
            });
            
            // Enable undo button
            undoBtn.disabled = false;

            // Update display
            renderBookingsTable();
            recomputeInsights();
            
            // Clear form and focus for next entry
            bookingForm.reset();
            studentsInput.focus();
        }

        // Parse comma-separated student IDs
        function parseStudentIds(inputString) {
            const studentIds = [];
            const parts = inputString.split(',');
            
            for (let i = 0; i < parts.length; i++) {
                const trimmed = parts[i].trim();
                if (trimmed.length > 0) {
                    // Validate USIU student ID format (6 digits)
                    if (/^\d{6}$/.test(trimmed)) {
                        studentIds.push(trimmed);
                    } else {
                        showError(`Invalid student ID format: ${trimmed}. USIU student IDs must be 6 digits (e.g., 663221)`);
                        return [];
                    }
                }
            }
            
            return studentIds;
        }

        // Check if time is within operating hours (08:00-19:00)
        function isWithinOperatingHours(timeString) {
            if (!timeString || timeString.length !== 5) {
                return false;
            }
            
            const hour = parseInt(timeString.substring(0, 2));
            const minute = parseInt(timeString.substring(3, 5));
            
            // Using === for strict equality comparison as required
            if (hour === 8 && minute === 0) {
                return true; // 08:00 is valid
            }
            
            if (hour >= 9 && hour <= 19) {
                return true; // 09:00-19:00 are valid
            }
            
            return false; // 20:00 and beyond are invalid
        }

        // Find existing booking for a pod and time
        function findBooking(podId, timeString) {
            for (let i = 0; i < bookings.length; i++) {
                const booking = bookings[i];
                if (booking.podId === podId && booking.time === timeString) {
                    return booking;
                }
            }
            return null;
        }

        // Check if student has a booking in another pod at the same time
        function hasCrossPodClash(studentId, timeString, currentPodId) {
            for (let i = 0; i < bookings.length; i++) {
                const booking = bookings[i];
                if (booking.time === timeString && booking.podId !== currentPodId) {
                    for (let j = 0; j < booking.students.length; j++) {
                        if (booking.students[j] === studentId) {
                            return true;
                        }
                    }
                }
            }
            return false;
        }

        // Handle table click events (event delegation for remove buttons)
        function handleTableClick(event) {
            if (event.target.classList.contains('remove-btn')) {
                const row = event.target.closest('tr');
                const index = parseInt(row.dataset.index);
                
                bookings.splice(index, 1);
                renderBookingsTable();
                recomputeInsights();
            }
        }

        // Render the bookings table
        function renderBookingsTable() {
            bookingsTableBody.innerHTML = '';
            
            for (let i = 0; i < bookings.length; i++) {
                const booking = bookings[i];
                const row = document.createElement('tr');
                row.dataset.index = i;
                
                row.innerHTML = `
                    <td>${i + 1}</td>
                    <td>${booking.podId}</td>
                    <td>${booking.time}</td>
                    <td>${booking.students.length}</td>
                    <td>${booking.students.join(', ')}</td>
                    <td><button class="remove-btn">Delete Booking</button></td>
                `;
                
                bookingsTableBody.appendChild(row);
            }
        }

        // Recompute all insights
        function recomputeInsights() {
            // Total bookings
            totalBookingsEl.textContent = bookings.length;
            
            // Unique students (using loops, not Set)
            const uniqueStudents = [];
            for (let i = 0; i < bookings.length; i++) {
                const booking = bookings[i];
                for (let j = 0; j < booking.students.length; j++) {
                    const studentId = booking.students[j];
                    let found = false;
                    
                    for (let k = 0; k < uniqueStudents.length; k++) {
                        if (uniqueStudents[k] === studentId) {
                            found = true;
                            break;
                        }
                    }
                    
                    if (!found) {
                        uniqueStudents.push(studentId);
                    }
                }
            }
            uniqueStudentsEl.textContent = uniqueStudents.length;
            
            // Busiest hour
            const hourCounts = {};
            for (let i = 0; i < bookings.length; i++) {
                const booking = bookings[i];
                const hour = booking.time;
                if (!hourCounts[hour]) {
                    hourCounts[hour] = 0;
                }
                hourCounts[hour] += booking.students.length;
            }
            
            let busiestHours = [];
            let maxStudents = 0;
            
            // Find the maximum number of students
            for (const hour in hourCounts) {
                if (hourCounts[hour] > maxStudents) {
                    maxStudents = hourCounts[hour];
                }
            }
            
            // Find all hours with the maximum number of students
            for (const hour in hourCounts) {
                if (hourCounts[hour] === maxStudents && maxStudents > 0) {
                    busiestHours.push(hour);
                }
            }
            
            // Convert 24-hour format to 12-hour format with AM/PM
            let displayBusiestHours = 'None';
            if (busiestHours.length > 0) {
                const formattedHours = busiestHours.map(hour => {
                    const hourNum = parseInt(hour.substring(0, 2));
                    const minute = hour.substring(3, 5);
                    let period = 'AM';
                    let displayHour = hourNum;
                    
                    if (hourNum >= 12) {
                        period = 'PM';
                        if (hourNum > 12) {
                            displayHour = hourNum - 12;
                        }
                    }
                    if (hourNum === 0) {
                        displayHour = 12;
                    }
                    
                    return `${displayHour}:${minute}${period}`;
                });
                
                displayBusiestHours = formattedHours.join(' & ');
            }
            
            busiestHourEl.textContent = displayBusiestHours;
            
            // Duplicate attempts
            duplicateAttemptsEl.textContent = duplicateAttempts;
            
            // Update flagged duplicates section
            totalViolationsEl.textContent = duplicateAttempts;
            duplicateStudentsEl.textContent = duplicateStudentsCount;
            crossPodConflictsEl.textContent = crossPodConflictsCount;
            
            // Fill rates per pod
            renderFillRates();
        }

        // Render fill rates for each pod
        function renderFillRates() {
            fillRatesContainer.innerHTML = '';
            
            for (let i = 0; i < pods.length; i++) {
                const pod = pods[i];
                const podBookings = [];
                
                // Find all bookings for this pod
                for (let j = 0; j < bookings.length; j++) {
                    if (bookings[j].podId === pod.id) {
                        podBookings.push(bookings[j]);
                    }
                }
                
                // Calculate fill rate
                let totalBookedSeats = 0;
                const usedSlots = podBookings.length;
                const totalPossibleSeats = pod.capacity * 12; // 12 hours (08:00-20:00)
                
                for (let j = 0; j < podBookings.length; j++) {
                    totalBookedSeats += podBookings[j].students.length;
                }
                
                const fillRate = usedSlots > 0 ? 
                    (totalBookedSeats / (totalPossibleSeats * usedSlots)) * 100 : 0;
                
                const fillRateItem = document.createElement('div');
                fillRateItem.className = 'fill-rate-item';
                fillRateItem.innerHTML = `
                    <div class="fill-rate-label">${pod.id}</div>
                    <div class="fill-rate-value">${roundToDecimal(fillRate)}%</div>
                `;
                
                fillRatesContainer.appendChild(fillRateItem);
            }
        }

        // Round to 1 decimal place
        function roundToDecimal(number) {
            return Math.round(number * 10) / 10;
        }

        // Clear error messages
        function clearErrors() {
            errorsContainer.style.display = 'none';
            errorsContainer.textContent = '';
        }

        // Show error message
        function showError(message) {
            errorsContainer.style.display = 'block';
            errorsContainer.textContent = message;
        }

        // Handle undo last booking
        function handleUndoBooking() {
            if (bookingHistoryStack.length === 0) {
                showError("No bookings to undo.");
                return;
            }
            
            // Pop the last booking from the stack
            const lastBooking = bookingHistoryStack.pop();
            
            // Find and remove the booking from the main array
            for (let i = 0; i < bookings.length; i++) {
                const booking = bookings[i];
                if (booking.podId === lastBooking.booking.podId && 
                    booking.time === lastBooking.booking.time) {
                    
                    // Remove the booking
                    bookings.splice(i, 1);
                    break;
                }
            }
            
            // Disable undo button if no more bookings in stack
            if (bookingHistoryStack.length === 0) {
                undoBtn.disabled = true;
            }
            
            // Update display
            renderBookingsTable();
            recomputeInsights();
            
            // Show success message
            showSuccess(`Undone booking: ${lastBooking.booking.podId} at ${lastBooking.booking.time} (${lastBooking.booking.students.join(', ')})`);
        }

        // Show success message
        function showSuccess(message) {
            errorsContainer.style.display = 'block';
            errorsContainer.style.background = 'rgba(76, 175, 80, 0.1)';
            errorsContainer.style.border = '2px solid var(--success-neon)';
            errorsContainer.style.color = 'var(--success-neon)';
            errorsContainer.textContent = message;
            
            // Reset to error styling after 3 seconds
            setTimeout(() => {
                errorsContainer.style.background = 'rgba(255, 68, 68, 0.1)';
                errorsContainer.style.border = '2px solid var(--error-neon)';
                errorsContainer.style.color = 'var(--error-neon)';
            }, 3000);
        }
    </script>
</body>
</html>
